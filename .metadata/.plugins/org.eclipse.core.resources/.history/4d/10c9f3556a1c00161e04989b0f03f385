package com.automatic.database;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.automatic.models.StudentModel;

public class FetchStudents
{
	public static StudentModel getStudentList()
	{
		DatabaseConnector connector = new DatabaseConnector();
		String queryString = "SELECT * FROM student_data";
		
		StudentModel model = new StudentModel();
		
		try {
			PreparedStatement statement = connector.getConnection().prepareStatement(queryString);
			ResultSet set = statement.executeQuery();
			
			if(set.next())
			{
				do
				{
					model.setFirstName(set.getString("first_name"));
					model.setSecondName(set.getString("second_name"));
					model.setStudentNumber(set.getString("student_number"));
					model.setCourse(set.getString("course"));
					model.setCourseDuration(set.getString("course_duration"));
					
				}while(set.next());
				
				
			}
			return model;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			System.out.println(e.getMessage());
		}
		return null;
	}

}
